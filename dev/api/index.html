<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · SolarFunctions.jl</title><meta name="title" content="API · SolarFunctions.jl"/><meta property="og:title" content="API · SolarFunctions.jl"/><meta property="twitter:title" content="API · SolarFunctions.jl"/><meta name="description" content="Documentation for SolarFunctions.jl."/><meta property="og:description" content="Documentation for SolarFunctions.jl."/><meta property="twitter:description" content="Documentation for SolarFunctions.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="SolarFunctions.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SolarFunctions.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a><ul class="internal"><li><a class="tocitem" href="#Solar-position-algorithm"><span>Solar position algorithm</span></a></li><li><a class="tocitem" href="#Clear-sky"><span>Clear-sky</span></a></li><li><a class="tocitem" href="#Atmosphere"><span>Atmosphere</span></a></li><li><a class="tocitem" href="#Irradiance"><span>Irradiance</span></a></li></ul></li><li><a class="tocitem" href="../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/nicomignoni/SolarFunctions.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/master/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><p>The list above reports all the functions implemented in <code>SolarFunctions.jl</code>. In the following, we group them into topic categories and we detail them.  </p><ul><li><a href="#SolarFunctions.aberration_correction"><code>SolarFunctions.aberration_correction</code></a></li><li><a href="#SolarFunctions.absolute_airmass"><code>SolarFunctions.absolute_airmass</code></a></li><li><a href="#SolarFunctions.altitude2pressure"><code>SolarFunctions.altitude2pressure</code></a></li><li><a href="#SolarFunctions.aod_bb_hulstrom1980"><code>SolarFunctions.aod_bb_hulstrom1980</code></a></li><li><a href="#SolarFunctions.apparent_sidereal_greenwich_time"><code>SolarFunctions.apparent_sidereal_greenwich_time</code></a></li><li><a href="#SolarFunctions.apparent_sun_longitude"><code>SolarFunctions.apparent_sun_longitude</code></a></li><li><a href="#SolarFunctions.ascending_moon_longitude"><code>SolarFunctions.ascending_moon_longitude</code></a></li><li><a href="#SolarFunctions.clearsky_haurwitz"><code>SolarFunctions.clearsky_haurwitz</code></a></li><li><a href="#SolarFunctions.clearsky_ineichen"><code>SolarFunctions.clearsky_ineichen</code></a></li><li><a href="#SolarFunctions.clearsky_simplified_solis"><code>SolarFunctions.clearsky_simplified_solis</code></a></li><li><a href="#SolarFunctions.day_angle"><code>SolarFunctions.day_angle</code></a></li><li><a href="#SolarFunctions.delta_T"><code>SolarFunctions.delta_T</code></a></li><li><a href="#SolarFunctions.dew_temperature2relative_humidity_oke2018"><code>SolarFunctions.dew_temperature2relative_humidity_oke2018</code></a></li><li><a href="#SolarFunctions.elliptic_obliquity"><code>SolarFunctions.elliptic_obliquity</code></a></li><li><a href="#SolarFunctions.extraterrestrial_irradiance_asce"><code>SolarFunctions.extraterrestrial_irradiance_asce</code></a></li><li><a href="#SolarFunctions.extraterrestrial_irradiance_nrel"><code>SolarFunctions.extraterrestrial_irradiance_nrel</code></a></li><li><a href="#SolarFunctions.extraterrestrial_irradiance_spencer1971"><code>SolarFunctions.extraterrestrial_irradiance_spencer1971</code></a></li><li><a href="#SolarFunctions.geocentric_latitude"><code>SolarFunctions.geocentric_latitude</code></a></li><li><a href="#SolarFunctions.geocentric_longitude"><code>SolarFunctions.geocentric_longitude</code></a></li><li><a href="#SolarFunctions.geocentric_sun_ascension"><code>SolarFunctions.geocentric_sun_ascension</code></a></li><li><a href="#SolarFunctions.geocentric_sun_declination"><code>SolarFunctions.geocentric_sun_declination</code></a></li><li><a href="#SolarFunctions.heliocentric_latitude"><code>SolarFunctions.heliocentric_latitude</code></a></li><li><a href="#SolarFunctions.heliocentric_longitude"><code>SolarFunctions.heliocentric_longitude</code></a></li><li><a href="#SolarFunctions.heliocentric_radius"><code>SolarFunctions.heliocentric_radius</code></a></li><li><a href="#SolarFunctions.julian_century"><code>SolarFunctions.julian_century</code></a></li><li><a href="#SolarFunctions.julian_ephemeris_century"><code>SolarFunctions.julian_ephemeris_century</code></a></li><li><a href="#SolarFunctions.julian_ephemeris_day"><code>SolarFunctions.julian_ephemeris_day</code></a></li><li><a href="#SolarFunctions.julian_ephemeris_millenium"><code>SolarFunctions.julian_ephemeris_millenium</code></a></li><li><a href="#SolarFunctions.linke_turbidity_kasten1996"><code>SolarFunctions.linke_turbidity_kasten1996</code></a></li><li><a href="#SolarFunctions.linke_turbidity_meteotest"><code>SolarFunctions.linke_turbidity_meteotest</code></a></li><li><a href="#SolarFunctions.mean_elliptic_obliquity"><code>SolarFunctions.mean_elliptic_obliquity</code></a></li><li><a href="#SolarFunctions.mean_moon_anomaly"><code>SolarFunctions.mean_moon_anomaly</code></a></li><li><a href="#SolarFunctions.mean_moon_elongation_from_sun"><code>SolarFunctions.mean_moon_elongation_from_sun</code></a></li><li><a href="#SolarFunctions.mean_sidereal_greenwich_time"><code>SolarFunctions.mean_sidereal_greenwich_time</code></a></li><li><a href="#SolarFunctions.mean_sun_anomaly"><code>SolarFunctions.mean_sun_anomaly</code></a></li><li><a href="#SolarFunctions.mean_sun_longitude"><code>SolarFunctions.mean_sun_longitude</code></a></li><li><a href="#SolarFunctions.moon_latitude_argument"><code>SolarFunctions.moon_latitude_argument</code></a></li><li><a href="#SolarFunctions.nutation_coefficients"><code>SolarFunctions.nutation_coefficients</code></a></li><li><a href="#SolarFunctions.nutation_longitude"><code>SolarFunctions.nutation_longitude</code></a></li><li><a href="#SolarFunctions.nutation_obliquity"><code>SolarFunctions.nutation_obliquity</code></a></li><li><a href="#SolarFunctions.observer_local_hour"><code>SolarFunctions.observer_local_hour</code></a></li><li><a href="#SolarFunctions.precipitable_water_gueymard94"><code>SolarFunctions.precipitable_water_gueymard94</code></a></li><li><a href="#SolarFunctions.pressure2altitude"><code>SolarFunctions.pressure2altitude</code></a></li><li><a href="#SolarFunctions.radial_distance_equatorial_plane"><code>SolarFunctions.radial_distance_equatorial_plane</code></a></li><li><a href="#SolarFunctions.radial_distance_rotational_axis"><code>SolarFunctions.radial_distance_rotational_axis</code></a></li><li><a href="#SolarFunctions.reduced_observer_latitude"><code>SolarFunctions.reduced_observer_latitude</code></a></li><li><a href="#SolarFunctions.relative_airmass_gueymard1993"><code>SolarFunctions.relative_airmass_gueymard1993</code></a></li><li><a href="#SolarFunctions.relative_airmass_gueymard2003"><code>SolarFunctions.relative_airmass_gueymard2003</code></a></li><li><a href="#SolarFunctions.relative_airmass_kasten1966"><code>SolarFunctions.relative_airmass_kasten1966</code></a></li><li><a href="#SolarFunctions.relative_airmass_pickering2002"><code>SolarFunctions.relative_airmass_pickering2002</code></a></li><li><a href="#SolarFunctions.relative_airmass_simple"><code>SolarFunctions.relative_airmass_simple</code></a></li><li><a href="#SolarFunctions.relative_airmass_young1994"><code>SolarFunctions.relative_airmass_young1994</code></a></li><li><a href="#SolarFunctions.relative_airmass_youngirvine1967"><code>SolarFunctions.relative_airmass_youngirvine1967</code></a></li><li><a href="#SolarFunctions.relative_arimass_kastenyoung1989"><code>SolarFunctions.relative_arimass_kastenyoung1989</code></a></li><li><a href="#SolarFunctions.relative_humidity2dew_temperature_oke2018"><code>SolarFunctions.relative_humidity2dew_temperature_oke2018</code></a></li><li><a href="#SolarFunctions.sun_ascension_parallax"><code>SolarFunctions.sun_ascension_parallax</code></a></li><li><a href="#SolarFunctions.sun_equatorial_horizontal_parallax"><code>SolarFunctions.sun_equatorial_horizontal_parallax</code></a></li><li><a href="#SolarFunctions.topocentric_apparent_elevation"><code>SolarFunctions.topocentric_apparent_elevation</code></a></li><li><a href="#SolarFunctions.topocentric_astronomical_azimuth"><code>SolarFunctions.topocentric_astronomical_azimuth</code></a></li><li><a href="#SolarFunctions.topocentric_azimuth"><code>SolarFunctions.topocentric_azimuth</code></a></li><li><a href="#SolarFunctions.topocentric_elevation"><code>SolarFunctions.topocentric_elevation</code></a></li><li><a href="#SolarFunctions.topocentric_elevation_correction"><code>SolarFunctions.topocentric_elevation_correction</code></a></li><li><a href="#SolarFunctions.topocentric_local_hour"><code>SolarFunctions.topocentric_local_hour</code></a></li><li><a href="#SolarFunctions.topocentric_sun_ascension"><code>SolarFunctions.topocentric_sun_ascension</code></a></li><li><a href="#SolarFunctions.topocentric_sun_declination"><code>SolarFunctions.topocentric_sun_declination</code></a></li></ul><h2 id="Solar-position-algorithm"><a class="docs-heading-anchor" href="#Solar-position-algorithm">Solar position algorithm</a><a id="Solar-position-algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Solar-position-algorithm" title="Permalink"></a></h2><p>The following functions implement the Solar Position Algorithm, as described in [<a href="../references/#reda2004solar">1</a>]. </p><h3 id="Julian-period-conversions"><a class="docs-heading-anchor" href="#Julian-period-conversions">Julian period conversions</a><a id="Julian-period-conversions-1"></a><a class="docs-heading-anchor-permalink" href="#Julian-period-conversions" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.delta_T"><a class="docstring-binding" href="#SolarFunctions.delta_T"><code>SolarFunctions.delta_T</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">delta_T(datetime::DateTime)</code></pre><p>Calculates the difference between Terrestrial Dynamical Time (TD) and Universal Time (UT)</p><p>It is evaluated as a piecewise polynomial, as per <a href="https://eclipse.gsfc.nasa.gov/SEcat5/deltatpoly.html">NASA</a>, which in turn refer to [<a href="../references/#morrison2004historical">2</a>, <a href="../references/#stephenson1986atlas">3</a>].</p><p>Note that <span>$\Delta T$</span> is unknown for years before <code>-1999</code> and after <code>3000</code>. Values could be calculated for such intervals, although they are not intended to be used for these years.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L12-L20">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.julian_ephemeris_day"><a class="docstring-binding" href="#SolarFunctions.julian_ephemeris_day"><code>SolarFunctions.julian_ephemeris_day</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">julian_ephemeris_day(julian_day::Real, ΔT::Real)</code></pre><p>A continuous count of days measured in uniform Ephemeris Time (or its successors), calculated as follows</p><p class="math-container">\[J_{\text{ed}} = J_{\text{d}} + \frac{\Delta T}{86400}\]</p><p>where:</p><ul><li><span>$J_{\text{d}}$</span> is the <a href="https://en.wikipedia.org/wiki/Julian_day">Julian day</a>, which can be computed using <a href="https://docs.julialang.org/en/v1/stdlib/Dates/#Dates.datetime2julian"><code>Dates.datetime2julian</code></a></li><li><span>$\Delta T$</span> is the difference between Terrestrial Dynamical Time and Universal Time, which can be computed using <a href="#SolarFunctions.delta_T"><code>delta_T</code></a>.  </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L78-L88">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.julian_century"><a class="docstring-binding" href="#SolarFunctions.julian_century"><code>SolarFunctions.julian_century</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">julian_century(julian_day::Real)</code></pre><p>A time interval of exactly 36,525 days (365.25 days × 100) used as a standard unit in astronomy, calculated as follows </p><p class="math-container">\[J_{\text{c}} = \frac{J_{\text{d}} - 2451545}{36525}\]</p><p>where <span>$J_{\text{d}}$</span> is the <a href="https://en.wikipedia.org/wiki/Julian_day">Julian day</a>, which can be computed using <a href="https://docs.julialang.org/en/v1/stdlib/Dates/#Dates.datetime2julian"><code>Dates.datetime2julian</code></a>.. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L93-L101">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.julian_ephemeris_century"><a class="docstring-binding" href="#SolarFunctions.julian_ephemeris_century"><code>SolarFunctions.julian_ephemeris_century</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">julian_ephemeris_century(julian_ephemeris_day::Real)</code></pre><p>A 36,525-day interval measured specifically in Ephemeris Time (or its modern dynamical time scales) for high-precision astronomical modeling. It is calculated as follows </p><p class="math-container">\[J_{\text{ec}} = \frac{J_{\text{ed}} - 2451545}{36525}\]</p><p>where <span>$J_{\text{ed}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_day"><code>julian_ephemeris_day</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L106-L114">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.julian_ephemeris_millenium"><a class="docstring-binding" href="#SolarFunctions.julian_ephemeris_millenium"><code>SolarFunctions.julian_ephemeris_millenium</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">julian_ephemeris_millenium(julian_ephemeris_century::Real)</code></pre><p>A 1,000-year interval equal to 365,250 ephemeris days, defined within Ephemeris Time for long-term astronomical calculations. It is calculated as </p><p class="math-container">\[J_{\text{em}} = \frac{J_{\text{ec}}}{10}\]</p><p>where <span>$J_{\text{ec}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_century"><code>julian_ephemeris_century</code></a>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L119-L127">source</a></section></details></article><h3 id="Heliocentric-quantites"><a class="docs-heading-anchor" href="#Heliocentric-quantites">Heliocentric quantites</a><a id="Heliocentric-quantites-1"></a><a class="docs-heading-anchor-permalink" href="#Heliocentric-quantites" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.heliocentric_longitude"><a class="docstring-binding" href="#SolarFunctions.heliocentric_longitude"><code>SolarFunctions.heliocentric_longitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">heliocentric_longitude(julian_ephemeris_millenium::Real)</code></pre><p>A celestial object&#39;s angular distance north or south of the ecliptic plane as measured from the Sun. </p><p>It is calculated as a polynomial expression, where the coefficients are collected in <span>$\mathcal{M} = \{\mathbf{M}_i\}_{i=1}^6$</span>, with <span>$\mathbf{M}_i \in \mathbb{R}^{n_i \times 3}$</span> being the coeffient matrix for the <span>$i$</span>-th polynomal coefficient <span>$c_{\mu, i}$</span>.  The heliocentric longitude, <span>$\mu_{\text{hel}}$</span>, is thus calculated as</p><p class="math-container">\[    \begin{align*}
        c_{\mu, i} &amp;= \sum_{j = 1}^{n_i} M^{(j,1)}_i \cos(M^{(j,2)}_i + M^{(j,3)}_i J_{\text{em}}) \\
        \mu_{\text{hel}} &amp;= \frac{180}{\pi} \frac{1}{1e8} \sum_{i = 1}^6 c_{\ell, i} J_{\text{em}}^{i-1} \mod 360
    \end{align*}\]</p><p>where <span>$J_{\text{em}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_millenium"><code>julian_ephemeris_millenium</code></a>. The <span>$180/\pi$</span> term coverts <span>$\mu_{\text{hel}}$</span> from radians to degrees. Moreover, the <span>$\mod(\cdot)$</span> operator ensures that the results remains in the <code>[0, 360]</code> range.</p><p>The coefficient matrices in <span>$\mathcal{M}$</span> are collected in <code>SolarFunctions.EARTH_PERIODIC_TERMS.M</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L152-L168">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.heliocentric_latitude"><a class="docstring-binding" href="#SolarFunctions.heliocentric_latitude"><code>SolarFunctions.heliocentric_latitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">heliocentric_latitude(julian_ephemeris_millenium::Real)</code></pre><p>A celestial object&#39;s angular position around the Sun measured in the ecliptic plane from a defined reference direction.</p><p>It is calculated as a polynomial expression, where the coefficients are collected in <span>$\mathcal{L} = \{\mathbf{L}_i\}_{i=1}^2$</span>, with <span>$\mathbf{L}_i \in \mathbb{R}^{n_i \times 3}$</span> being the coeffient matrix for the <span>$i$</span>-th polynomal coefficient <span>$c_{\lambda, i}$</span>.  The heliocentric latitude, <span>$\lambda_{\text{hel}}$</span>, is thus calculated as</p><p class="math-container">\[    \begin{align*}
        c_{\lambda, i} &amp;= \sum_{j = 1}^{n_i} L^{(j,1)}_i \cos(L^{(j,2)}_i + L^{(j,3)}_i J_{\text{em}}) \\
        \lambda_{\text{hel}} &amp;= \frac{180}{\pi} \frac{1}{1e8} \sum_{i = 1}^2 c_{b, i} J_{\text{em}}^{i-1}
    \end{align*}\]</p><p>where <span>$J_{\text{em}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_millenium"><code>julian_ephemeris_millenium</code></a>. The <span>$180/\pi$</span> term coverts <span>$\lambda_{\text{hel}}$</span> from radians to degrees. </p><p>The coefficient matrices in <span>$\mathcal{L}$</span> are collected in <code>SolarFunctions.EARTH_PERIODIC_TERMS.L</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L177-L193">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.heliocentric_radius"><a class="docstring-binding" href="#SolarFunctions.heliocentric_radius"><code>SolarFunctions.heliocentric_radius</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">heliocentric_radius(julian_ephemeris_millenium::Real)</code></pre><p>The distance from the Sun to the celestial object in a chosen heliocentric coordinate system. In this case, it corresponds to the Earth-Sun distance.</p><p>It is calculated as a polynomial expression, where the coefficients are collected in <span>$\mathcal{R} = \{\mathbf{R}_i\}_{i=1}^5$</span>, with <span>$\mathbf{R}_i \in \mathbb{R}^{n_i \times 3}$</span> being the coeffient matrix for the <span>$i$</span>-th polynomal coefficient <span>$c_{R, i}$</span>.  The heliocentric radius, <span>$R_{\text{hel}}$</span>, is thus calculated as</p><p class="math-container">\[    \begin{align*}
        c_{R, i} &amp;= \sum_{j = 1}^{n_i} R^{(j,1)}_i \cos(R^{(j,2)}_i + R^{(j,3)}_i J_{\text{em}}) \\
        R_{\text{hel}} &amp;= \frac{180}{\pi} \frac{1}{1e8} \sum_{i = 1}^5 c_{r, i} J_{\text{em}}^{i-1}
    \end{align*}\]</p><p>where <span>$J_{\text{em}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_millenium"><code>julian_ephemeris_millenium</code></a>. </p><p>The coefficient matrices in <span>$\mathcal{R}$</span> are collected in <code>SolarFunctions.EARTH_PERIODIC_TERMS.R</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L202-L218">source</a></section></details></article><h3 id="Geocentric-quantities"><a class="docs-heading-anchor" href="#Geocentric-quantities">Geocentric quantities</a><a id="Geocentric-quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Geocentric-quantities" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.geocentric_longitude"><a class="docstring-binding" href="#SolarFunctions.geocentric_longitude"><code>SolarFunctions.geocentric_longitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">geocentric_longitude(heliocentric_longitude::Real)</code></pre><p>A celestial object&#39;s ecliptic longitude as measured from Earth’s center, referenced to the ecliptic plane and the vernal equinox. It is calculated as follows </p><p class="math-container">\[\mu_{\text{geo}} = \mu_{\text{hel}} + 180 \mod 360\]</p><p>where <span>$\mu_{\text{hel}}$</span> is the <a href="#SolarFunctions.heliocentric_longitude"><code>heliocentric_longitude</code></a> [deg], and the <span>$\mod(\cdot)$</span> operator ensures that the results remains in the <code>[0, 360]</code> range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L226-L234">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.geocentric_latitude"><a class="docstring-binding" href="#SolarFunctions.geocentric_latitude"><code>SolarFunctions.geocentric_latitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">geocentric_latitude(heliocentric_latitude::Real)</code></pre><p>A celestial object&#39;s angular distance north or south of the ecliptic plane as measured from Earth’s center. It is calculated as <span>$\lambda_{\text{geo}} = -\lambda_{\text{hel}}$</span> where <span>$\lambda_{\text{hel}}$</span> is the <a href="#SolarFunctions.heliocentric_latitude"><code>heliocentric_latitude</code></a> [deg]. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L239-L243">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.geocentric_sun_ascension"><a class="docstring-binding" href="#SolarFunctions.geocentric_sun_ascension"><code>SolarFunctions.geocentric_sun_ascension</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">geocentric_sun_ascension(
    apparent_sun_longitude::Real,
    elliptic_obliquity::Real,
    geocentric_latitude::Real
)</code></pre><p>The angle measured eastward from the geocentric meridian, that locates a direction or point relative to Earth’s ellipsoid rather than its rotational axis. It is calculated as follows</p><p class="math-container">\[    \sigma_{\text{geo}} = \text{atan2}(\sin\tilde{\mu}_{\odot} \cos\omega_{\text{ell}} - \tan\lambda_{\text{geo}}\sin\omega_{\text{ell}}, \cos\tilde{\mu}_{\odot})\]</p><p>where</p><ul><li><span>$\tilde{\mu}_{\odot}$</span> corresponds to <a href="#SolarFunctions.apparent_sun_longitude"><code>apparent_sun_longitude</code></a> [deg] </li><li><span>$\omega_{\text{ell}}$</span> corresponds to <a href="#SolarFunctions.elliptic_obliquity"><code>elliptic_obliquity</code></a> [deg]</li><li><span>$\lambda_{\text{geo}}$</span> corresponds to <a href="#SolarFunctions.geocentric_latitude"><code>geocentric_latitude</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L248-L263">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.geocentric_sun_declination"><a class="docstring-binding" href="#SolarFunctions.geocentric_sun_declination"><code>SolarFunctions.geocentric_sun_declination</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">geocentric_sun_declination(
    apparent_sun_longitude::Real,
    elliptic_obliquity::Real,
    geocentric_latitude::Real,
)</code></pre><p>The Sun’s angular distance, north or south of Earth’s equatorial plane as measured from Earth’s center. It is calculated as follows </p><p class="math-container">\[    \delta_{\text{geo}} = \text{asin}(\sin \lambda_{\text{geo}} \cos \omega_{\text{ell}} + \cos \lambda_{\text{geo}} \sin \omega_{\text{ell}} \sin \tilde{\mu}_{\odot}) \mod 360\]</p><p>where:</p><ul><li><span>$\tilde{\mu}_{\odot}$</span> corresponds to <a href="#SolarFunctions.apparent_sun_longitude"><code>apparent_sun_longitude</code></a> [deg]</li><li><span>$\omega_{\text{ell}}$</span> corresponds to <a href="#SolarFunctions.elliptic_obliquity"><code>elliptic_obliquity</code></a> [deg]</li><li><span>$\lambda_{\text{geo}}$</span> corresponds to <a href="#SolarFunctions.geocentric_latitude"><code>geocentric_latitude</code></a> [deg]</li></ul><p>Moreover, the <span>$\mod(\cdot)$</span> operator ensures that the results remains in the <code>[0, 360]</code> range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L276-L293">source</a></section></details></article><h3 id="Nutation-quantities"><a class="docs-heading-anchor" href="#Nutation-quantities">Nutation quantities</a><a id="Nutation-quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Nutation-quantities" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.mean_moon_elongation_from_sun"><a class="docstring-binding" href="#SolarFunctions.mean_moon_elongation_from_sun"><code>SolarFunctions.mean_moon_elongation_from_sun</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mean_moon_elongation_from_sun(julian_ephemeris_century::Real)</code></pre><p>The average angular separation between the Moon and the Sun as measured along the ecliptic. It is calculated as follows</p><p class="math-container">\[    \bar{e}_{\bullet} = 297.85036 + 445267.111480J_{\text{ec}} − 0.0019142J_{\text{ec}}^2 + \frac{J_{\text{ec}}^3}{189474}\]</p><p>where <span>$J_{\text{ec}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_century"><code>julian_ephemeris_century</code></a>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L305-L313">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.mean_sun_anomaly"><a class="docstring-binding" href="#SolarFunctions.mean_sun_anomaly"><code>SolarFunctions.mean_sun_anomaly</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mean_sun_anomaly(julian_ephemeris_century::Real)</code></pre><p>The angular position of the Sun in its elliptical orbit, measured from perihelion and increasing uniformly in time. It is calculated as follows</p><p class="math-container">\[    \bar{a}_{\odot} = 357.52772 + 35999.050340J_{\text{ec}} − 0.0001603J_{\text{ec}}^2 − \frac{J_{\text{ec}}^3}{300000}\]</p><p>where <span>$J_{\text{ec}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_century"><code>julian_ephemeris_century</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L319-L327">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.mean_moon_anomaly"><a class="docstring-binding" href="#SolarFunctions.mean_moon_anomaly"><code>SolarFunctions.mean_moon_anomaly</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mean_moon_anomaly(julian_ephemeris_century::Real)</code></pre><p>The uniformly increasing angular position of the Moon in its elliptical orbit measured from perigee. It is calculated as follows</p><p class="math-container">\[    \bar{a}_{\bullet} = 134.96298 + 477198.867398J_{\text{ec}} + 0.0086972J_{\text{ec}}^2 + \frac{J_{\text{ec}}^3}{56250}\]</p><p>where <span>$J_{\text{ec}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_century"><code>julian_ephemeris_century</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L333-L341">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.moon_latitude_argument"><a class="docstring-binding" href="#SolarFunctions.moon_latitude_argument"><code>SolarFunctions.moon_latitude_argument</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">moon_latitude_argument(julian_ephemeris_century::Real)</code></pre><p>The angle from the Moon’s ascending node to its position measured along its orbit, using mean (unperturbed) orbital elements. It is calculated as follows</p><p class="math-container">\[    \lambda_{\bullet} = 93.27191 + 483202.017538J_{\text{ec}} - 0.0036825J_{\text{ec}}^2 + \frac{J_{\text{ec}}^3}{327270}\]</p><p>where <span>$J_{\text{ec}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_century"><code>julian_ephemeris_century</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L347-L355">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.ascending_moon_longitude"><a class="docstring-binding" href="#SolarFunctions.ascending_moon_longitude"><code>SolarFunctions.ascending_moon_longitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ascending_moon_longitude(julian_ephemeris_century::Real)</code></pre><p>The ecliptic longitude referenced to the mean equinox of the date, of the point where the Moon’s mean orbit crosses northward through the ecliptic. It is calculated as follows</p><p class="math-container">\[    \mu_{\bullet} = 125.04452 - 1934.136261J_{\text{ec}} + 0.0020708J_{\text{ec}}^2 + \frac{J_{\text{ec}}^3}{450000}\]</p><p>where <span>$J_{\text{ec}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_century"><code>julian_ephemeris_century</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L361-L369">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.nutation_coefficients"><a class="docstring-binding" href="#SolarFunctions.nutation_coefficients"><code>SolarFunctions.nutation_coefficients</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nutation_coefficients(julian_ephemeris_century::Real)</code></pre><p>Constructs the vector of weights for evaluating the <a href="#SolarFunctions.nutation_longitude"><code>nutation_longitude</code></a> and <a href="#SolarFunctions.nutation_obliquity"><code>nutation_obliquity</code></a>. It is calculated as follows</p><p class="math-container">\[    \begin{align*}
        w_i &amp;= \sum_{j=1}^5 X_j Y_{ij} \\
        \mathbf{X} &amp;= [\bar{e}_{\bullet}, \bar{a}_{\odot}, \bar{a}_{\bullet}, \lambda_{\bullet}, \mu_{\bullet}]^\top 
    \end{align*}\]</p><p>The coefficients in matrix <span>$\mathbf{Y} \in \mathbb{R}^{m \times 5}$</span> are collected in <code>SolarFunctions.EARTH_PERIODIC_TERMS.Y</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L375-L386">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.nutation_longitude"><a class="docstring-binding" href="#SolarFunctions.nutation_longitude"><code>SolarFunctions.nutation_longitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nutation_longitude(julian_ephemeris_century::Real, nutation_coefficients::Vector)</code></pre><p>The small periodic variation in Earth’s ecliptic longitude caused by gravitational torques from the Moon and Sun. It is calculated as follows</p><p class="math-container">\[    \mu_{\text{nut}} = \frac{1}{3.6e7} \sum_{i=1}^n (\Psi_{i,1} + \Psi_{i,2} J_{\text{ec}}) \sin w_i\]</p><p>where:</p><ul><li><span>$\boldsymbol{\Psi} \in \mathbb{R}^{m \times 2}$</span> is the coefficient matrix, whose terms are collected in <code>SolarFunctions.EARTH_PERIODIC_TERMS.ψ</code></li><li><span>$J_{\text{ec}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_century"><code>julian_ephemeris_century</code></a>.</li><li><span>$w_i$</span> is the <span>$i$</span>-th term of the <a href="#SolarFunctions.nutation_coefficients"><code>nutation_coefficients</code></a> vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L398-L409">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.nutation_obliquity"><a class="docstring-binding" href="#SolarFunctions.nutation_obliquity"><code>SolarFunctions.nutation_obliquity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">nutation_obliquity(julian_ephemeris_century::Real, nutation_coefficients::Vector)</code></pre><p>The small periodic variation in Earth’s axial tilt (obliquity), <span>$\omega_{\text{nut}}$</span>, resulting from gravitational perturbations. It is calculated as follows</p><p class="math-container">\[    \omega_{\text{nut}} = \frac{1}{3.6e7} \sum_{i=1}^n (E_{i,1} + E_{i,2} J_{\text{ec}}) \cos w_i\]</p><p>where: </p><ul><li><span>$\boldsymbol{E} \in \mathbb{R}^{m \times 2}$</span> is the coefficient matrix, whose terms are collected in <code>SolarFunctions.EARTH_PERIODIC_TERMS.ϵ</code></li><li><span>$J_{\text{ec}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_century"><code>julian_ephemeris_century</code></a>.</li><li><span>$w_i$</span> is the <span>$i$</span>-th term of the <a href="#SolarFunctions.nutation_coefficients"><code>nutation_coefficients</code></a> vector</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L417-L428">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.mean_elliptic_obliquity"><a class="docstring-binding" href="#SolarFunctions.mean_elliptic_obliquity"><code>SolarFunctions.mean_elliptic_obliquity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mean_elliptic_obliquity(julian_ephemeris_millenium::Real)</code></pre><p>The angle between Earth’s equator and the mean (long-term averaged) ecliptic defined by an unperturbed elliptical Earth orbit. It is calculated as follows</p><p class="math-container">\[    \begin{align*}
        U &amp;= \frac{J_{\text{em}}}{10} \\
        \bar{\omega}_{\text{ell}} &amp;= 84381.448 − 4680.93U − 155.0U^2 + 1999.25U^3 − 51.38U^4 − \\
                    &amp; \qquad 249.67U^5 − 39.05U^6 + 7.12U^7 + 27.87U^8 + 5.79U^9 + 2.45U^{10}
    \end{align*}\]</p><p>where <span>$J_{\text{em}}$</span> is the <a href="#SolarFunctions.julian_ephemeris_millenium"><code>julian_ephemeris_millenium</code></a>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L436-L448">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.elliptic_obliquity"><a class="docstring-binding" href="#SolarFunctions.elliptic_obliquity"><code>SolarFunctions.elliptic_obliquity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">elliptic_obliquity(mean_elliptic_obliquity::Real, nutation_obliquity::Real)</code></pre><p>The angle between Earth’s equator and the mean ecliptic defined as an ideal, unperturbed ellipse. It is calculated as follows</p><p class="math-container">\[\omega_{\text{ell}} = \bar{\omega}_{\text{ell}} / 3600 + \omega_{\text{nut}}\]</p><p>where:</p><ul><li><span>$\bar{\omega}_{\text{ell}}$</span> corresponds to <a href="#SolarFunctions.mean_elliptic_obliquity"><code>mean_elliptic_obliquity</code></a> [deg]</li><li><span>$\omega_{\text{nut}}$</span> corresponds to <a href="#SolarFunctions.nutation_obliquity"><code>nutation_obliquity</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L455-L465">source</a></section></details></article><h3 id="Solar-longitude"><a class="docs-heading-anchor" href="#Solar-longitude">Solar longitude</a><a id="Solar-longitude-1"></a><a class="docs-heading-anchor-permalink" href="#Solar-longitude" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.aberration_correction"><a class="docstring-binding" href="#SolarFunctions.aberration_correction"><code>SolarFunctions.aberration_correction</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">aberration_correction(heliocentric_radius::Real)</code></pre><p>An adjustment applied to celestial coordinates to account for the apparent displacement caused by Earth’s motion through space. It is calculated as follows </p><p class="math-container">\[\beta = -\frac{20.4898}{3600 R_{\text{hel}}}\]</p><p>where <span>$R_{\text{hel}}$</span> corresponds to the <a href="#SolarFunctions.heliocentric_radius"><code>heliocentric_radius</code></a> [AU].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L470-L478">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.apparent_sun_longitude"><a class="docstring-binding" href="#SolarFunctions.apparent_sun_longitude"><code>SolarFunctions.apparent_sun_longitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">apparent_sun_longitude(
    geocentric_longitude::Real,
    nutation_longitude::Real,
    aberration_correction::Real
)</code></pre><p>The Sun’s ecliptic longitude after applying corrections for nutation and aberration. It is calculated as follows</p><p class="math-container">\[\tilde{\mu}_{\odot} = \mu_{\text{geo}} + \mu_{\text{nut}} + \beta\]</p><p>where:</p><ul><li><span>$\mu_{\text{geo}}$</span> corresponds to <a href="#SolarFunctions.geocentric_longitude"><code>geocentric_longitude</code></a> [deg]</li><li><span>$\mu_{\text{nut}}$</span> corresponds to <a href="#SolarFunctions.nutation_longitude"><code>nutation_longitude</code></a> [deg]</li><li><span>$\beta$</span> corresponds to <a href="#SolarFunctions.aberration_correction"><code>aberration_correction</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L483-L498">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.mean_sun_longitude"><a class="docstring-binding" href="#SolarFunctions.mean_sun_longitude"><code>SolarFunctions.mean_sun_longitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mean_sun_longitude(julian_ephemeris_millenium::Real)</code></pre><p>The Sun’s ecliptic longitude calculated from a uniformly moving fictitious Sun on the ecliptic. It is calculated as follows</p><p class="math-container">\[    \bar{\mu}_{\odot} = 280.4664567 + 360007.6982779J_{\text{em}} + 0.03032028J_{\text{em}}^2 + \frac{J_{\text{em}}^3}{49931} - \frac{J_{\text{em}}^4}{15300} - \frac{J_{\text{em}}^5}{2000000}\]</p><p>where <span>$J_{\text{em}}$</span> corresponds to the <a href="#SolarFunctions.julian_ephemeris_millenium"><code>julian_ephemeris_millenium</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L507-L515">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.mean_sidereal_greenwich_time"><a class="docstring-binding" href="#SolarFunctions.mean_sidereal_greenwich_time"><code>SolarFunctions.mean_sidereal_greenwich_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">mean_sidereal_greenwich_time(julian_day::Real, julian_century::Real)</code></pre><p>The hour angle of the mean vernal equinox at the Greenwich meridian reflecting Earth’s rotation relative to the fixed stars without nutation effects. It is calculated as follows</p><p class="math-container">\[    \bar{t}_{\text{gw}} = 280.46061837 + 360.98564736629(J_{\text{d}} − 2451545.0) + 
             0.000387933J_{\text{c}}^2 - \frac{J_{\text{c}}^3}{38710000} \mod 360\]</p><p>where <span>$J_{\text{d}}$</span> is the <a href="https://en.wikipedia.org/wiki/Julian_day"><code>Julian Day</code></a>, which can be computed using <a href="https://docs.julialang.org/en/v1/stdlib/Dates/#Dates.datetime2julian"><code>Dates.datetime2julian</code></a>. Moreover, the <span>$\mod(\cdot)$</span> operator ensures that the results remains in the <code>[0, 360]</code> range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L523-L532">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.apparent_sidereal_greenwich_time"><a class="docstring-binding" href="#SolarFunctions.apparent_sidereal_greenwich_time"><code>SolarFunctions.apparent_sidereal_greenwich_time</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">apparent_sidereal_greenwich_time(
    mean_sidereal_greenwich_time::Real,
    nutation_longitude::Real, 
    elliptic_obliquity::Real
)</code></pre><p>Greenwich sidereal time corrected for the effects of nutation giving the true rotation angle relative to the apparent equinox. It is calculated as </p><p class="math-container">\[\tilde{t}_{\text{gw}} = \bar{t}_{\text{gw}} + \mu_{\text{nut}} \cos \omega_{\text{ell}}\]</p><p>where:</p><ul><li><span>$\bar{t}_{\text{gw}}$</span> corresponds to <a href="#SolarFunctions.mean_sidereal_greenwich_time"><code>mean_sidereal_greenwich_time</code></a> </li><li><span>$\mu_{\text{nut}}$</span>corresponds to <a href="#SolarFunctions.nutation_longitude"><code>nutation_longitude</code></a> </li><li><span>$\omega_{\text{ell}}$</span>corresponds to <a href="#SolarFunctions.elliptic_obliquity"><code>elliptic_obliquity</code></a> </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L540-L555">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.observer_local_hour"><a class="docstring-binding" href="#SolarFunctions.observer_local_hour"><code>SolarFunctions.observer_local_hour</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">observer_local_hour(
    observer_longitude::Real, 
    apparent_sidereal_greenwich_time::Real, 
    geocentric_sun_ascension::Real
)</code></pre><p>The angle between the observer’s local meridian and a celestial object measured westward on the celestial sphere. It is calculated as </p><p class="math-container">\[h_{\text{obs}} = \tilde{t}_{\text{gw}} + \mu_{\text{obs}} - \sigma_{\text{geo}} \mod 360\]</p><p>where:</p><ul><li><span>$\mu_{\text{obs}}$</span> corresponds to the <code>observer_longitude</code></li><li><span>$\tilde{t}_{\text{gw}}$</span> corresponds to <a href="#SolarFunctions.apparent_sidereal_greenwich_time"><code>apparent_sidereal_greenwich_time</code></a></li><li><span>$\sigma_{\text{geo}}$</span> corresponds to <a href="#SolarFunctions.geocentric_sun_ascension"><code>geocentric_sun_ascension</code></a></li></ul><p>Moreover, the <span>$\mod(\cdot)$</span> operator ensures that the results remains in the <code>[0, 360]</code> range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L564-L580">source</a></section></details></article><h3 id="Solar-parallax"><a class="docs-heading-anchor" href="#Solar-parallax">Solar parallax</a><a id="Solar-parallax-1"></a><a class="docs-heading-anchor-permalink" href="#Solar-parallax" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.reduced_observer_latitude"><a class="docstring-binding" href="#SolarFunctions.reduced_observer_latitude"><code>SolarFunctions.reduced_observer_latitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">reduced_observer_latitude(observer_latitude::Real)</code></pre><p>The angle whose tangent equals the tangent of the geodetic latitude scaled by Earth’s polar-to-equatorial radius ratio, representing the point’s projection onto the surface of the reference ellipsoid. It is calculated as follows</p><p class="math-container">\[\lambda_{\text{red}} = \text{atan}(0.99664719\tan(\lambda_{\text{obs}}))\]</p><p>where <span>$\lambda_{\text{obs}}$</span> corresponds to the <code>observer_latitude</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L593-L601">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.radial_distance_equatorial_plane"><a class="docstring-binding" href="#SolarFunctions.radial_distance_equatorial_plane"><code>SolarFunctions.radial_distance_equatorial_plane</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">radial_distance_equatorial_plane(
    observer_latitude::Real,
    observer_altitude::Real,
    reduced_observer_latitude::Real
)</code></pre><p>The perpendicular distance of a point from Earth’s equatorial plane. It is calculated as follows</p><p class="math-container">\[d_{\text{eqt}} = \cos \lambda_{\text{red}} + A_{\text{obs}} \frac{\cos \lambda_{\text{obs}}}{6378140}\]</p><p>where:</p><ul><li><span>$\lambda_{\text{obs}}$</span> corresponds to <code>observer_latitude</code></li><li><span>$A_{\text{obs}}$</span> corresponds to <code>observer_altitude</code></li><li><span>$\lambda_{\text{red}}$</span> corresponds to <a href="#SolarFunctions.reduced_observer_latitude"><code>reduced_observer_latitude</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L606-L621">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.radial_distance_rotational_axis"><a class="docstring-binding" href="#SolarFunctions.radial_distance_rotational_axis"><code>SolarFunctions.radial_distance_rotational_axis</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">radial_distance_rotational_axis(
    observer_latitude::Real, 
    observer_altitude::Real,
    reduced_observer_latitude::Real
)</code></pre><p>The perpendicular distance of a point from Earth’s spin axis. It calculates as </p><p class="math-container">\[d_{\text{rot}} = 0.99664719\sin \lambda_{\text{red}} + A_{\text{obs}} \frac{\sin \lambda_{\text{obs}}}{6378140}\]</p><p>where:</p><ul><li><span>$\lambda_{\text{obs}}$</span> corresponds to <code>observer_latitude</code></li><li><span>$A_{\text{obs}}$</span> corresponds to <code>observer_altitude</code></li><li><span>$\lambda_{\text{red}}$</span> corresponds to <a href="#SolarFunctions.reduced_observer_latitude"><code>reduced_observer_latitude</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L631-L646">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.sun_equatorial_horizontal_parallax"><a class="docstring-binding" href="#SolarFunctions.sun_equatorial_horizontal_parallax"><code>SolarFunctions.sun_equatorial_horizontal_parallax</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sun_equatorial_horizontal_parallax(heliocentric_radius::Real)</code></pre><p>The angle between the Sun’s direction as seen from Earth’s center and from a point on the equator at sea level when the Sun is on the horizon. It is calculated as follows</p><p class="math-container">\[\xi_{\text{hor}} = \frac{8.794}{3600 R_{\text{hel}}}\]</p><p>where <span>$R_{\text{hel}}$</span> corresponds to the <a href="#SolarFunctions.heliocentric_radius"><code>heliocentric_radius</code></a>, in astronomical units.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L656-L664">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.sun_ascension_parallax"><a class="docstring-binding" href="#SolarFunctions.sun_ascension_parallax"><code>SolarFunctions.sun_ascension_parallax</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">sun_ascension_parallax(
    radial_distance_equatorial_plane::Real, 
    sun_equatorial_horizontal_parallax::Real, 
    geocentric_sun_declination::Real, 
    observer_local_hour::Real
)</code></pre><p>The correction to the Sun’s right ascension due to the difference between geocentric and topocentric perspectives. It is calculated as follows</p><p class="math-container">\[    \xi_{\text{asc}} = \text{atan2}(-d_{\text{eqt}} \sin \xi_{\text{hor}} \sin h_{\text{obs}}, \cos \delta_{\text{geo}} - d_{\text{eqt}} \sin \xi_{\text{hor}} \cos h_{\text{obs}})\]</p><p>where:</p><ul><li><span>$d_{\text{eqt}}$</span> corresponds to <a href="#SolarFunctions.radial_distance_equatorial_plane"><code>radial_distance_equatorial_plane</code></a>) [m]</li><li><span>$\xi_{\text{hor}}$</span> corresponds to <a href="#SolarFunctions.sun_equatorial_horizontal_parallax"><code>sun_equatorial_horizontal_parallax</code></a> [deg]</li><li><span>$\delta_{\text{geo}}$</span> corresponds to <a href="#SolarFunctions.geocentric_sun_declination"><code>geocentric_sun_declination</code></a> [deg] </li><li><span>$h_{\text{obs}}$</span> corresponds to <a href="#SolarFunctions.observer_local_hour"><code>observer_local_hour</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L669-L686">source</a></section></details></article><h3 id="Topocentric-quantities"><a class="docs-heading-anchor" href="#Topocentric-quantities">Topocentric quantities</a><a id="Topocentric-quantities-1"></a><a class="docs-heading-anchor-permalink" href="#Topocentric-quantities" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.topocentric_sun_ascension"><a class="docstring-binding" href="#SolarFunctions.topocentric_sun_ascension"><code>SolarFunctions.topocentric_sun_ascension</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">topocentric_sun_ascension(
    geocentric_sun_ascension::Real, 
    sun_ascension_parallax::Real
)</code></pre><p>The Sun’s right ascension as viewed from the observer’s actual location on Earth’s surface. It is calculated as follows </p><p class="math-container">\[\sigma_{\text{top}} = \sigma_{\text{geo}} + \xi_{\text{asc}}\]</p><p>where:</p><ul><li><span>$\sigma_{\text{geo}}$</span> corresponds to <a href="#SolarFunctions.geocentric_sun_ascension"><code>geocentric_sun_ascension</code></a> [deg]</li><li><span>$\xi_{\text{asc}}$</span> corresponds to <a href="#SolarFunctions.sun_ascension_parallax"><code>sun_ascension_parallax</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L703-L716">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.topocentric_local_hour"><a class="docstring-binding" href="#SolarFunctions.topocentric_local_hour"><code>SolarFunctions.topocentric_local_hour</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">topocentric_local_hour(
    observer_local_hour::Real,
    sun_ascension_parallax::Real
)</code></pre><p>The hour angle of a celestial object as seen from the observer’s exact location on Earth’s surface rather than its center. It is calculated follows</p><p class="math-container">\[h_{\text{top}} = h_{\text{obs}} - \xi_{\text{asc}}\]</p><p>where:</p><ul><li><span>$h_{\text{obs}}$</span> corresponds to the <a href="#SolarFunctions.observer_local_hour"><code>observer_local_hour</code></a> [deg]</li><li><span>$\xi_{\text{asc}}$</span> corresponds to the <a href="#SolarFunctions.sun_ascension_parallax"><code>sun_ascension_parallax</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L724-L737">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.topocentric_sun_declination"><a class="docstring-binding" href="#SolarFunctions.topocentric_sun_declination"><code>SolarFunctions.topocentric_sun_declination</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">topocentric_sun_declination(
    radial_distance_equatorial_plane::Real, 
    radial_distance_rotational_axis::Real, 
    sun_equatorial_horizontal_parallax::Real, 
    geocentric_sun_declination::Real, 
    observer_local_hour::Real, 
    sun_ascension_parallax::Real
)</code></pre><p>The Sun’s declination as viewed from the observer’s actual location on Earth’s surface. It is calculated as follows:</p><p class="math-container">\[    \delta_{\text{top}} = \text{atan2}((\sin \delta_{\text{geo}} - d_{\text{rot}}\sin \xi_{\text{hor}})\cos \xi_{\text{asc}}, \cos \delta_{\text{geo}} - d_{\text{eqt}}\sin \xi_{\text{hor}} \cos h_{\text{obs}})\]</p><p>where:</p><ul><li><span>$d_{\text{eqt}}$</span> corresponds to <a href="#SolarFunctions.radial_distance_equatorial_plane"><code>radial_distance_equatorial_plane</code></a> [m]</li><li><span>$d_{\text{rot}}$</span> corresponds to <a href="#SolarFunctions.radial_distance_rotational_axis"><code>radial_distance_rotational_axis</code></a> [m]</li><li><span>$\xi_{\text{hor}}$</span> corresponds to <a href="#SolarFunctions.sun_equatorial_horizontal_parallax"><code>sun_equatorial_horizontal_parallax</code></a> [deg]</li><li><span>$\delta_{\text{geo}}$</span> corresponds to <a href="#SolarFunctions.geocentric_sun_declination"><code>geocentric_sun_declination</code></a> [deg]</li><li><span>$h_{\text{obs}}$</span> corresponds to <a href="#SolarFunctions.observer_local_hour"><code>observer_local_hour</code></a> [deg]</li><li><span>$\xi_{\text{asc}}$</span> corresponds to <a href="#SolarFunctions.sun_ascension_parallax"><code>sun_ascension_parallax</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L745-L766">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.topocentric_apparent_elevation"><a class="docstring-binding" href="#SolarFunctions.topocentric_apparent_elevation"><code>SolarFunctions.topocentric_apparent_elevation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">topocentric_apparent_elevation(
    observer_latitude::Real,
    topocentric_sun_declination::Real,
    topocentric_local_hour::Real
)</code></pre><p>Topocentric elevation angle without atmospheric refraction correction. It is calculated as follows</p><p class="math-container">\[    \tilde{\eta}_{\text{top}} = \text{asin}(\sin \lambda_{\text{obs}} \sin \delta_{\text{top}} + \cos \lambda_{\text{obs}} \cos \delta_{\text{top}} \cos h_{\text{top}})\]</p><p>where:</p><ul><li><span>$\lambda_{\text{obs}}$</span> corresponds to <code>observer_latitude</code> [deg]</li><li><span>$\delta_{\text{top}}$</span> corresponds to <a href="#SolarFunctions.topocentric_sun_declination"><code>topocentric_sun_declination</code></a> [deg]</li><li><span>$h_{\text{top}}$</span> corresponds to <a href="#SolarFunctions.topocentric_local_hour"><code>topocentric_local_hour</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L786-L801">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.topocentric_elevation_correction"><a class="docstring-binding" href="#SolarFunctions.topocentric_elevation_correction"><code>SolarFunctions.topocentric_elevation_correction</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">topocentric_elevation_correction(
    temperature::Real,
    pressure::Real,
    topocentric_apparent_elevation::Real
)</code></pre><p>The adjustment applied to an object’s observed altitude to account for the bending of its light as it passes through Earth’s atmosphere. It is calculated as follows:</p><p class="math-container">\[    \hat{\eta}_{\text{top}} = \frac{P}{1010} \frac{283}{273 + T} \frac{1.02}{60\tan(\tilde{\eta}_{\text{top}} + \frac{10.3}{\tilde{\eta}_{\text{top}} + 5.11})}\]</p><p>where:</p><ul><li><span>$T$</span> corresponds to the local temperature [C]</li><li><span>$P$</span> corresponds to the local pressure [mbar]</li><li><span>$\tilde{\eta}_{\text{top}}$</span> corresponds to the <a href="#SolarFunctions.topocentric_apparent_elevation"><code>topocentric_apparent_elevation</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L812-L827">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.topocentric_elevation"><a class="docstring-binding" href="#SolarFunctions.topocentric_elevation"><code>SolarFunctions.topocentric_elevation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">function topocentric_elevation(
    topocentric_apparent_elevation::Real, 
    topocentric_elevation_correction::Real
)</code></pre><p>The angle between the Sun and the observer’s local horizon, measured at the observer’s location. It is calculated as follows </p><p class="math-container">\[\eta_{\text{top}} = \tilde{\eta}_{\text{top}} + \hat{\eta}_{\text{top}}\]</p><p>where:</p><ul><li><span>$\hat{\eta}_{\text{top}}$</span> corresponds to the <a href="#SolarFunctions.topocentric_elevation_correction"><code>topocentric_elevation_correction</code></a> [deg]</li><li><span>$\tilde{\eta}_{\text{top}}$</span> corresponds to the <a href="#SolarFunctions.topocentric_apparent_elevation"><code>topocentric_apparent_elevation</code></a> [deg]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L837-L850">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.topocentric_astronomical_azimuth"><a class="docstring-binding" href="#SolarFunctions.topocentric_astronomical_azimuth"><code>SolarFunctions.topocentric_astronomical_azimuth</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">topocentric_astronomical_azimuth(
    observer_latitude::Real, 
    topocentric_sun_declination::Real, 
    topocentric_local_hour::Real
)</code></pre><p>The Sun’s azimuth measured from true north eastward as seen from the observer’s location, based on astronomical (not navigational) convention. It is calculated as follows</p><p class="math-container">\[    \alpha_{\star, \text{top}} = \text{atan2}(\sin h_{\text{top}}, \cos h_{\text{obs}} \sin \lambda_{\text{obs}} - \tan \delta_{\text{top}} \cos \lambda_{\text{obs}}) \mod 360\]</p><p>where:</p><ul><li><span>$\lambda_{\text{obs}}$</span> corresponds to <code>observer_latitude</code> [deg]</li><li><span>$\delta_{\text{top}}$</span> corresponds to <a href="#SolarFunctions.topocentric_sun_declination"><code>topocentric_sun_declination</code></a> [deg]</li><li><span>$h_{\text{top}}$</span> corresponds to <a href="#SolarFunctions.topocentric_local_hour"><code>topocentric_local_hour</code></a> [deg]</li></ul><p>Moreover, the <span>$\mod(\cdot)$</span> operator ensures that the results remains in the <code>[0, 360]</code> range.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L858-L874">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.topocentric_azimuth"><a class="docstring-binding" href="#SolarFunctions.topocentric_azimuth"><code>SolarFunctions.topocentric_azimuth</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">topocentric_azimuth(topocentric_astronomical_azimuth::Real)</code></pre><p>The Sun’s azimuth from the observer’s location relative to a defined reference direction, typically true north, on the horizon. It is calculated as follows</p><p class="math-container">\[\alpha_{\text{top}} = \alpha_{\star, \text{top}} + 180 \mod 360\]</p><p>where <span>$\alpha_{\star, \text{top}}$</span> is the <a href="#SolarFunctions.topocentric_astronomical_azimuth"><code>topocentric_astronomical_azimuth</code></a> [deg].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/spa.jl#L886-L895">source</a></section></details></article><h2 id="Clear-sky"><a class="docs-heading-anchor" href="#Clear-sky">Clear-sky</a><a id="Clear-sky-1"></a><a class="docs-heading-anchor-permalink" href="#Clear-sky" title="Permalink"></a></h2><p>Implements different models to calculate the GHI, DNI, and DHI components under the clear sky assumption.</p><article><details class="docstring" open="true"><summary id="SolarFunctions.clearsky_ineichen"><a class="docstring-binding" href="#SolarFunctions.clearsky_ineichen"><code>SolarFunctions.clearsky_ineichen</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">clearsky_ineichen(
    sun_apparent_elevation::Real,
    observer_altitude::Real,
    absolute_airmass::Real,
    linke_turbidity::Real,
    extraterrestial_radiation::Real,
    perez_enhancement::Bool
)</code></pre><p>Implements the Ineichen and Perez clear sky model for global horizontal irradiance (GHI), direct normal irradiance (DNI), and calculates the clear-sky diffuse horizontal (DHI) component as the difference between GHI and DNI*cos(zenith) as presented in [<a href="../references/#ineichen2002new">4</a>, <a href="../references/#perez2002new">5</a>]. A report on clear sky models found the Ineichen/Perez model to have excellent performance with a minimal input data set [<a href="../references/#stein2012global">6</a>]. Default values for monthly Linke turbidity provided by SoDa [<a href="../references/#sodapro">7</a>, <a href="../references/#remund2003worldwide">8</a>].</p><p><strong>Arguments</strong></p><ul><li><code>sun_apparent_elevation::Real</code> - [deg] Refraction corrected solar elevation angle</li><li><code>observer_altitude::Real</code> - [m] Altitude above sea level.</li><li><code>absolute_airmass::Real</code> - Pressure corrected airmass.</li><li><code>linke_turbidity::Real</code> - Linke Turbidity.</li><li><code>extraterrestial_radiation::Real</code> - [W/m^2] Extraterrestrial irradiance.</li><li><code>perez_enhancement::Bool</code> - Controls if the Perez enhancement factor should be applied. Setting to <code>true</code> <a href="https://github.com/pvlib/pvlib-python/issues/435">may produce spurious results</a> for times when the Sun is near the horizon and the airmass is high.</li></ul><p><strong>Returns</strong></p><ul><li><code>dni::Real</code> - [W/m^2] direct normal irradiance </li><li><code>dhi::Real</code> - [W/m^2] direct horizontal irradiance </li><li><code>ghi::Real</code> - [W/m^2] global horizoantal irradiance</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/clearsky.jl#L1-L25">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.clearsky_haurwitz"><a class="docstring-binding" href="#SolarFunctions.clearsky_haurwitz"><code>SolarFunctions.clearsky_haurwitz</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">clearsky_haurwitz(sun_apparent_elevation::Real)</code></pre><p>Implements the Haurwitz clear sky model for global horizontal irradiance (GHI) as presented in [<a href="../references/#haurwitz1945insolation">9</a>, <a href="../references/#haurwitz1946insolation">10</a>]. A report on clear sky models found the Haurwitz model to have the best performance in terms of average monthly error among models which require only the Sun&#39;s elevation [<a href="../references/#stein2012global">6</a>].</p><p><strong>Arguments</strong></p><ul><li><code>sun_apparent_elevation::Real</code> - [deg] The apparent (refraction corrected) Sun&#39;s elevation angle in degrees.</li></ul><p><strong>Returns</strong></p><ul><li><code>ghi::Real</code> - [W/m^2] The modeled global horizonal irradiance in  provided by the Haurwitz clear-sky model.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/clearsky.jl#L71-L81">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.clearsky_simplified_solis"><a class="docstring-binding" href="#SolarFunctions.clearsky_simplified_solis"><code>SolarFunctions.clearsky_simplified_solis</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">clearsky_simplified_solis(
    sun_apparent_elevation::Real,
    aod700::Real,
    precipitable_water::Real,
    pressure::Real,
    extraterrestial_radiation::Real
)</code></pre><p>Calculate the clear sky GHI, DNI, and DHI according to the simplified Solis model. Reference [<a href="../references/#ineichen2008broadband">11</a>] describes the accuracy of the model as being 15, 20, and 18 W/m^2 for the beam, global, and diffuse components, respectively. Reference [<a href="../references/#ineichen2016validation">12</a>] provides comparisons with other clear sky models.</p><p><strong>Arguments</strong></p><ul><li><code>sun_apparent_elevation::Real</code> - [degrees] The apparent elevation of the sun above the horizon.</li><li><code>aod700::Real</code> - The aerosol optical depth at 700 nm. Algorithm derived for values between 0 and 0.45.</li><li><code>precipitable_water::Real</code> - [cm] The precipitable water of the atmosphere. Algorithm derived for values between 0.2 and 10 cm. Values less than 0.2 will be assumed to be equal to 0.2.</li><li><code>pressure::Real</code> - [Pa] The atmospheric pressure. Algorithm derived for altitudes between sea level and 7000 m, or 101325 and 41000 Pascals.</li><li><code>extraterrestial_radiation::Real</code> - [W/m^2] Extraterrestrial irradiance. The units of <code>extraterrestial_radiation</code> determine the units of the output.</li></ul><p><strong>Returns</strong></p><ul><li><code>dni::Real</code> - [W/m^2] direct normal irradiance </li><li><code>dhi::Real</code> - [W/m^2] direct horizontal irradiance </li><li><code>ghi::Real</code> - [W/m^2] global horizoantal irradiance</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/clearsky.jl#L88-L110">source</a></section></details></article><h2 id="Atmosphere"><a class="docs-heading-anchor" href="#Atmosphere">Atmosphere</a><a id="Atmosphere-1"></a><a class="docs-heading-anchor-permalink" href="#Atmosphere" title="Permalink"></a></h2><h3 id="Linke-turbidity"><a class="docs-heading-anchor" href="#Linke-turbidity">Linke turbidity</a><a id="Linke-turbidity-1"></a><a class="docs-heading-anchor-permalink" href="#Linke-turbidity" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.aod_bb_hulstrom1980"><a class="docstring-binding" href="#SolarFunctions.aod_bb_hulstrom1980"><code>SolarFunctions.aod_bb_hulstrom1980</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">aod_bb_hulstrom1980(aod380::Real, aod500::Real)</code></pre><p>Approximate broadband aerosol optical depth (AOD) as proposed in [<a href="../references/#bird1980direct">13</a>, <a href="../references/#bird1981review">14</a>], which develops a correlation for broadband aerosol optical depth using two wavelengths, 380 nm and 500 nm. Arguments <code>aod380</code> and <code>aod500</code> are the AOD measured at 380 nm and 500 nm, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L28-L32">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.linke_turbidity_meteotest"><a class="docstring-binding" href="#SolarFunctions.linke_turbidity_meteotest"><code>SolarFunctions.linke_turbidity_meteotest</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">linke_turbidity_meteotest(
    observer_latitude::Real,
    observer_longitude::Real,
    month_index::Int,
)</code></pre><p><a href="https://en.wikipedia.org/wiki/Bilinear_interpolation">Bilinear interpolation</a> of the Linke turbidity array, for the corrsponding latitude, longitude, and month index values. </p><p>In the the Linke turbidity array, rows represent global latitudes from 90 to -90 degrees; columns represent global longitudes from -180 to 180; depth (third dimension) represents months of the year from January (1) to December (12). </p><p>The array is based on the tabular data in [<a href="../references/#remund2009aerosol">15</a>, Sec. 8].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L37-L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.linke_turbidity_kasten1996"><a class="docstring-binding" href="#SolarFunctions.linke_turbidity_kasten1996"><code>SolarFunctions.linke_turbidity_kasten1996</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">linke_turbidity_kasten1996(
    absolute_airmass::Real, 
    precipitable_water::Real, 
    aod_bb::Real
)</code></pre><p>Calculate Linke turbidity using Kasten pyrheliometric formula.</p><p>Note that broadband aerosol optical depth (AOD) can be approximated by AOD measured at 700 nm according to Molineaux [<a href="../references/#molineaux1998equivalence">16</a>]. Bird and Hulstrom offer an alternate approximation using AOD measured at 380 nm and 500 nm.</p><p>Based on original implementation by Armel Oumbe. Note that these calculations are only valid for airmass less than 5 and precipitable water less than 5 cm.</p><p><strong>Arguments</strong></p><ul><li><code>absolute_airmass::Real</code> - Pressure-adjusted airmass.</li><li><code>precipitable_water::Real</code> - [cm] Precipitable water. </li><li><code>aod_bb::Real</code> - broadband AOD. </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L74-L91">source</a></section></details></article><h4 id="Altitude-and-pressure"><a class="docs-heading-anchor" href="#Altitude-and-pressure">Altitude and pressure</a><a id="Altitude-and-pressure-1"></a><a class="docs-heading-anchor-permalink" href="#Altitude-and-pressure" title="Permalink"></a></h4><article><details class="docstring" open="true"><summary id="SolarFunctions.pressure2altitude"><a class="docstring-binding" href="#SolarFunctions.pressure2altitude"><code>SolarFunctions.pressure2altitude</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pressure2altitude(pressure::Real)</code></pre><p>Determine altitude, <span>$A$</span> [m], from site <code>pressure</code> <span>$P$</span> [Pa]. The following assumptions [<a href="../references/#psas2004altitudepressure">17</a>] hold:</p><ul><li>Base pressure: 101325 Pa</li><li>Temperature at zero altitude: 288.15 K</li><li>Gravitational acceleration: 9.80665 m/s^2</li><li>Lapse rate: -6.5E-3 K/m</li><li>Gas constant for air: 287.053 J/(kg K)</li><li>Relative Humidity: 0%</li></ul><p class="math-container">\[    A = 44331.5 - 4946.62P^{0.190263}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L118-L133">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.altitude2pressure"><a class="docstring-binding" href="#SolarFunctions.altitude2pressure"><code>SolarFunctions.altitude2pressure</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">altitude2pressure(altitude::Real)</code></pre><p>Determine site pressure, <span>$P$</span> [Pa], from altitude <span>$A$</span> [m]. It follows the same assumption of <a href="#SolarFunctions.pressure2altitude"><code>pressure2altitude</code></a>.</p><p class="math-container">\[    P = 100.0\left(\frac{44331.514 - A}{11880.516}\right)^{\frac{1}{0.1902632}}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L138-L146">source</a></section></details></article><h3 id="Airmass"><a class="docs-heading-anchor" href="#Airmass">Airmass</a><a id="Airmass-1"></a><a class="docs-heading-anchor-permalink" href="#Airmass" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.absolute_airmass"><a class="docstring-binding" href="#SolarFunctions.absolute_airmass"><code>SolarFunctions.absolute_airmass</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">absolute_airmass(relative_airmass::Real, pressure::Real=101325.0)</code></pre><p>Determine absolute (pressure-adjusted) airmass, <span>$a_\text{abs}$</span> from relative airmass, <span>$a_\text{reò}$</span>, and pressure, <span>$P$</span> [Pa], [<a href="../references/#gueymard1993critical">18</a>].</p><p class="math-container">\[    a_{\text{abs}} = a_{\text{rel}} \frac{P}{P_{\text{atm}}} \]</p><p>where <span>$P_{\text{atm}}$</span> is the atmospheric pressure.  </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L151-L160">source</a></section></details></article><p>The following functions return the relative (not pressure-adjusted) airmass at sea level, for different models. Some models use apparent (refraction-adjusted) zenith angle while other models use true (not refraction-adjusted) zenith angle. Apparent zenith angles should be calculated at sea level. A comparison among several models is reported in [<a href="../references/#stein2012global">6</a>]. </p><article><details class="docstring" open="true"><summary id="SolarFunctions.relative_airmass_simple"><a class="docstring-binding" href="#SolarFunctions.relative_airmass_simple"><code>SolarFunctions.relative_airmass_simple</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_airmass_simple(sun_apparent_elevation::Real)</code></pre><p>Calculates the relative airmass as <span>$m_{\text{air, rel}} = -\sec \tilde{\eta}_{\text{top}}$</span>, where \tilde{\eta}<em>{\text{top}} is the Sun&#39;s [topocentric</em>apparent<em>elevation](@ref) [deg]. Note that this returns <code>-Inf</code> at `sun</em>apparent_elevation=0`.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L165-L169">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.relative_airmass_kasten1966"><a class="docstring-binding" href="#SolarFunctions.relative_airmass_kasten1966"><code>SolarFunctions.relative_airmass_kasten1966</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_airmass_kasten1966(sun_apparent_elevation::Real)</code></pre><p>Computes the relative airmass as proposed in [<a href="../references/#kasten1965new">19</a>] as follows </p><p class="math-container">\[m_{\text{air, rel}} = \frac{1}{-\cos \tilde{\eta}_{\text{top}} + 0.15((3.885 + \tilde{\eta}_{\text{top}})^(-1.253))}\]</p><p>where <span>$\tilde{\eta}_{\text{top}}$</span> is the Sun&#39;s <a href="#SolarFunctions.topocentric_apparent_elevation"><code>topocentric_apparent_elevation</code></a> [deg].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L174-L182">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.relative_airmass_youngirvine1967"><a class="docstring-binding" href="#SolarFunctions.relative_airmass_youngirvine1967"><code>SolarFunctions.relative_airmass_youngirvine1967</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_airmass_youngirvine1967(sun_elevation::Real)</code></pre><p>Computes the relative airmass as proposed in [<a href="../references/#young1967multicolor">20</a>] as follows</p><p class="math-container">\[    m_{\text{air, rel}} = -\sec \eta_{\text{top}} (1 - 0.0012(\sec \eta_{\text{top}}^2 + 1))\]</p><p>where <span>$\eta_{\text{top}}$</span> is the Sun&#39;s <a href="#SolarFunctions.topocentric_elevation"><code>topocentric_elevation</code></a> [deg].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L188-L196">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.relative_arimass_kastenyoung1989"><a class="docstring-binding" href="#SolarFunctions.relative_arimass_kastenyoung1989"><code>SolarFunctions.relative_arimass_kastenyoung1989</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_arimass_kastenyoung1989(sun_apparent_elevation::Real)</code></pre><p>Computes the relative airmass as proposed in [<a href="../references/#kasten1989revised">21</a>] as follows</p><p class="math-container">\[    m_{\text{air, rel}} = \frac{1}{-\cos \tilde{\eta}_{\text{top}} + 0.50572((6.07995 + \tilde{\eta}_{\text{top}})^{-1.6364})}\]</p><p>where <span>$\tilde{\eta}_{\text{top}}$</span> is the Sun&#39;s <a href="#SolarFunctions.topocentric_apparent_elevation"><code>topocentric_apparent_elevation</code></a> [deg].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L202-L210">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.relative_airmass_gueymard1993"><a class="docstring-binding" href="#SolarFunctions.relative_airmass_gueymard1993"><code>SolarFunctions.relative_airmass_gueymard1993</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_airmass_gueymard1993(sun_apparent_elevation::Real)</code></pre><p>Computes the relative airmass as proposed in [<a href="../references/#gueymard1993critical">18</a>, <a href="../references/#gueymard1993development">22</a>] as follows</p><p class="math-container">\[    m_{\text{air, rel}} = \frac{1}{-\cos \tilde{\eta}_{\text{top}} + 0.00176759(90 - \tilde{\eta}_{\text{top}})((4.37515 + \tilde{\eta}_{\text{top}})^{- 1.21563})}\]</p><p>where <span>$\tilde{\eta}_{\text{top}}$</span> is the Sun&#39;s <a href="#SolarFunctions.topocentric_apparent_elevation"><code>topocentric_apparent_elevation</code></a> [deg].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L216-L224">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.relative_airmass_young1994"><a class="docstring-binding" href="#SolarFunctions.relative_airmass_young1994"><code>SolarFunctions.relative_airmass_young1994</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_airmass_young1994(sun_elevation::Real)</code></pre><p>Computes the relative airmass as proposed in [<a href="../references/#young1994air">23</a>] as follows</p><p class="math-container">\[    m_{\text{air, rel}} = \frac{1.002432\cos \eta_{\text{top}}^2 + 0.148386\cos \eta_{\text{top}} + 0.0096467}{\cos \eta_{\text{top}}^3 + 0.149864\cos \eta_{\text{top}}^2 + 0.0102963\cos m_{\text{air, rel}} + 0.000303978}\]</p><p>where <span>$\eta_{\text{top}}$</span> is the Sun&#39;s <a href="#SolarFunctions.topocentric_elevation"><code>topocentric_elevation</code></a> [deg].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L230-L238">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.relative_airmass_pickering2002"><a class="docstring-binding" href="#SolarFunctions.relative_airmass_pickering2002"><code>SolarFunctions.relative_airmass_pickering2002</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_airmass_pickering2002(sun_apparent_elevation::Real)</code></pre><p>Computes the relative airmass as proposed in [<a href="../references/#pickering2002southern">24</a>] as follows</p><p class="math-container">\[    m_{\text{air, rel}} = \frac{1}{\sin(\tilde{\eta}_{\text{top}} + 244.0 / (165 + 47.0\tilde{\eta}_{\text{top}}^{1.1}))}\]</p><p>where <span>$\eta_{\text{top}}$</span> is the Sun&#39;s <a href="#SolarFunctions.topocentric_elevation"><code>topocentric_elevation</code></a> [deg].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L245-L253">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.relative_airmass_gueymard2003"><a class="docstring-binding" href="#SolarFunctions.relative_airmass_gueymard2003"><code>SolarFunctions.relative_airmass_gueymard2003</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_airmass_gueymard2003(sun_apparent_elevation::Real)</code></pre><p>Computes the relative airmass as proposed in [<a href="../references/#gueymard2003direct">25</a>, <a href="../references/#gueymard2019clear">26</a>] as follow as follows</p><p class="math-container">\[    m_{\text{air, rel}} = -\cos \tilde{\eta}_{\text{top}} + \frac{0.48353(90 - \tilde{\eta}_{\text{top}})^{0.095846}}{(6.741 + \tilde{\eta}_{\text{top}})^{1.754}}\]</p><p>where <span>$\eta_{\text{top}}$</span> is the Sun&#39;s <a href="#SolarFunctions.topocentric_elevation"><code>topocentric_elevation</code></a> [deg].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L259-L267">source</a></section></details></article><h3 id="Precipitable-water-and-dew-temperature"><a class="docs-heading-anchor" href="#Precipitable-water-and-dew-temperature">Precipitable water and dew temperature</a><a id="Precipitable-water-and-dew-temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Precipitable-water-and-dew-temperature" title="Permalink"></a></h3><article><details class="docstring" open="true"><summary id="SolarFunctions.precipitable_water_gueymard94"><a class="docstring-binding" href="#SolarFunctions.precipitable_water_gueymard94"><code>SolarFunctions.precipitable_water_gueymard94</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">precipitable_water_gueymard94(
    air_temperature::Real, 
    relative_humidity::Real
)</code></pre><p>Calculates precipitable water (cm) from ambient air temperature [C] and relatively humidity [%] using an empirical model. The accuracy of this method is approximately 20% for moderate PW (1-3 cm) and less accurate otherwise.</p><p>The model was developed by expanding Eq. 1 in [<a href="../references/#gueymard1994analysis">27</a>, Eq. 1] and using [<a href="../references/#gueymard1994analysis">27</a>, Eq. 2]:</p><p class="math-container">\[    \begin{align*}
        Pw = 0.1 H_v \rho_v \\
        \rho_v = 216.7 R_H e_s
    \end{align*}\]</p><p><span>$Pw$</span> is the precipitable water (cm), <span>$H_v$</span> is the apparent water vapor scale height [km] and :math:<span>$\rho_v$</span> is the surface water vapor density [g/m^3]. The expression for <span>$H_v$</span> results from [<a href="../references/#gueymard1994analysis">27</a>, Eq. 4]:</p><p class="math-container">\[    H_v = 0.4976 + 1.5265 \frac{T}{273.15}
        + \exp \left(13.6897 \frac{T}{273.15}
        - 14.9188 \left( \frac{T}{273.15} \right)^3 \right)\]</p><p>In the expression for <span>$\rho_v$</span>, <span>$e_s$</span> is the saturation water vapor pressure [millibar]. The expression for <span>$e_s$</span> results from [<a href="../references/#keogh2004accurate">28</a>, Eq. 1]</p><p class="math-container">\[   e_s = \exp  \left(22.330 - 49.140 \frac{100}{T} -
       10.922 \left(\frac{100}{T}\right)^2 -
       0.39015 \frac{T}{100} \right)\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L273-L305">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.dew_temperature2relative_humidity_oke2018"><a class="docstring-binding" href="#SolarFunctions.dew_temperature2relative_humidity_oke2018"><code>SolarFunctions.dew_temperature2relative_humidity_oke2018</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">dew_temperature2relative_humidity_oke2018(
    air_temperature::Real,
    dew_temperature::Real
)</code></pre><p>Calculate relative humidity [%] from dewpoint temperature [°C] using the Magnus equation. Air temperature is expressed in °C. The Magnus equation coefficients (A, B, C) default to the values recommended by [<a href="../references/#oke2018guide">29</a>].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L322-L329">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.relative_humidity2dew_temperature_oke2018"><a class="docstring-binding" href="#SolarFunctions.relative_humidity2dew_temperature_oke2018"><code>SolarFunctions.relative_humidity2dew_temperature_oke2018</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">relative_humidity2dew_temperature_oke2018(
    air_temperature::Real,
    relative_humidity::Real
)</code></pre><p>Calculate dewpoint temperature using the Magnus equation. It corresponds to the inverse of <a href="#SolarFunctions.dew_temperature2relative_humidity_oke2018"><code>dew_temperature2relative_humidity_oke2018</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/atmosphere.jl#L343-L350">source</a></section></details></article><h2 id="Irradiance"><a class="docs-heading-anchor" href="#Irradiance">Irradiance</a><a id="Irradiance-1"></a><a class="docs-heading-anchor-permalink" href="#Irradiance" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="SolarFunctions.day_angle"><a class="docstring-binding" href="#SolarFunctions.day_angle"><code>SolarFunctions.day_angle</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">day_angle(datetime::DateTime, offset::Int)</code></pre><p>Calculates the day angle [deg] for the Earth&#39;s orbit around the Sun. For the Spencer method, <code>offset=1</code>; for the ASCE method, <code>offset=0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/irradiance.jl#L3-L7">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.extraterrestrial_irradiance_spencer1971"><a class="docstring-binding" href="#SolarFunctions.extraterrestrial_irradiance_spencer1971"><code>SolarFunctions.extraterrestrial_irradiance_spencer1971</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">extraterrestrial_irradiance_spencer1971(
    day_angle::Real, 
    solar_constant::Real
)</code></pre><p>Calculates the extraterrestrial irradiance [W/m^2], as proposed in [<a href="../references/#spencer1971fourier">30</a>], as follows,</p><p class="math-container">\[    R_{\text{ext}} = \Sigma(1.00011 + 0.034221\cos H + 0.00128\sin H + 
        0.000719\cos 2H + 7.7e-05\sin 2H)\]</p><p>where</p><ul><li><span>$H$</span> corresponds to <code>day_angle</code> [deg]</li><li><span>$\Sigma$</span> corresponds to <code>solar_constant</code> [W/m^2]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/irradiance.jl#L13-L27">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.extraterrestrial_irradiance_asce"><a class="docstring-binding" href="#SolarFunctions.extraterrestrial_irradiance_asce"><code>SolarFunctions.extraterrestrial_irradiance_asce</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">extraterrestrial_irradiance_asce(
    day_angle::Real,
    solar_constant::Real
)</code></pre><p>Calculates the extraterrestrial irradiance using the ASCE evapotranspiration equation [<a href="../references/#walter2000asce">31</a>] as follows</p><p class="math-container">\[    R_{\text{ext}} = \Sigma(1 + 0.033\cos(H))\]</p><p>where</p><ul><li><span>$H$</span> corresponds to <code>day_angle</code> [deg]</li><li><span>$\Sigma$</span> corresponds to <code>solar_constant</code> [W/m^2]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/irradiance.jl#L37-L50">source</a></section></details></article><article><details class="docstring" open="true"><summary id="SolarFunctions.extraterrestrial_irradiance_nrel"><a class="docstring-binding" href="#SolarFunctions.extraterrestrial_irradiance_nrel"><code>SolarFunctions.extraterrestrial_irradiance_nrel</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">extraterrestrial_irradiance_nrel(
    heliocentric_radius::Real,
    solar_constant::Real
)</code></pre><p>Calculates the extraterrestrial irradiance using the heliocentric radius [AU], i.e., the Earth-Sun distance, as implemented by the NREL SPA [<a href="../references/#reda2004solar">1</a>], as follows</p><p class="math-container">\[    R_{\text{ext}} = \Sigma / R_{\text{hel}}^2\]</p><p>where</p><ul><li><span>$R_{\text{hel}}$</span> corresponds to <code>heliocentric_radius</code>: [AU]</li><li><span>$\Sigma$</span> corresponds to <code>solar_constant</code>: [W/m^2]</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/nicomignoni/SolarFunctions.jl/blob/59ed6f811083bdd6e67ba2e2a0e5c54bf6b661dd/src/irradiance.jl#L59-L72">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../references/">References »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Sunday 7 December 2025 08:37">Sunday 7 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
